/* 
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
/**
 * Author:  x00131787
 * Created: 23-Nov-2016
 */


drop table currentaccount;
drop table savingsaccount;
drop table lodgements;
drop table withdrawals;
drop table custaccount;
drop table accounts;
drop table customer;
drop table branch;
drop sequence cust;
drop sequence withd;
drop sequence lodge;

create sequence cust start with 2 increment by 1;
create sequence withd start with 1 increment by 1;
create sequence lodge start with 1 increment by 1;

CREATE TABLE BRANCH(
BRANCH_ID VARCHAR2(255) NOT NULL PRIMARY KEY,
BRANCH_NAME VARCHAR2(255) NOT NULL,
BRANCH_ADDRESS VARCHAR2(255) NOT NULL
);

CREATE TABLE CUSTOMER(
cust_id NUMBER(20) primary key,
fname VARCHAR2(255) NOT NULL,
lname VARCHAR2(255) NOT NULL,
address VARCHAR2(255) NOT NULL,
branch_id VARCHAR2(255) NOT NULL,
foreign key (branch_id) references BRANCH ON DELETE CASCADE
);

CREATE TABLE ACCOUNTS(
id VARCHAR2(8) NOT NULL PRIMARY KEY,
TYPE VARCHAR2(255) NOT NULL CHECK (TYPE IN ('SA','CA')),
NOOFWITHDRAWALS NUMBER(20),
PIN NUMBER(4) NOT NULL,
NOOFLODGEMENTS NUMBER(20),
BALANCE NUMBER(20)
);

CREATE TABLE CUSTACCOUNT(
CUST_ID NUMBER(20),
ACC_ID VARCHAR2(255) NOT NULL,
PRIMARY KEY (CUST_ID, ACC_ID),
FOREIGN KEY (CUST_ID) REFERENCES CUSTOMER ON DELETE CASCADE,
FOREIGN KEY (ACC_ID) REFERENCES ACCOUNTS (ID) ON DELETE CASCADE
);

CREATE TABLE LODGEMENTS(
LID NUMBER(20) PRIMARY KEY,
LODGEMENTAMOUNT NUMBER(20),
LODGEMENTTYPE VARCHAR2(255) NOT NULL,
ID VARCHAR2(255) NOT NULL,
FOREIGN KEY (ID) REFERENCES ACCOUNTS ON DELETE CASCADE
);

CREATE TABLE WITHDRAWALS(
WID NUMBER(20) PRIMARY KEY,
WITHDRAWAMOUNT NUMBER(20),
WITHDRAWTYPE VARCHAR2(255) NOT NULL,
ID VARCHAR2(255) NOT NULL,
FOREIGN KEY (ID) REFERENCES ACCOUNTS ON DELETE CASCADE
);

CREATE TABLE SAVINGSACCOUNT(
ID VARCHAR2(255) NOT NULL,
WITHDRAWPENDING NUMBER(20),
WITHDRAWTYPE VARCHAR2(255),
FOREIGN KEY (ID) REFERENCES ACCOUNTS ON DELETE CASCADE
);

CREATE TABLE CURRENTACCOUNT(
ID VARCHAR2(255) NOT NULL,
FOREIGN KEY (ID) REFERENCES ACCOUNTS ON DELETE CASCADE
);

INSERT INTO BRANCH VALUES('AIB_Tal1', 'AIB_Tallaght', 'Village Green, Tallaght, Dublin 24');
INSERT INTO BRANCH VALUES('PTSB_1', 'Permanent_Tallaght', '8 Old Bawn Rd, Tallaght, Co. Dublin, DUBLIN 24');
INSERT INTO BRANCH VALUES('BOI_Tal1', 'BOI_Tallaght', 'Priorsgate, Main Road, Tallaght, Dublin 24');


INSERT INTO CUSTOMER VALUES(1,'Glen','Connolly','277 Glenview Park','AIB_Tal1');
/*INSERT INTO CUSTOMER VALUES(2,'Glen','Curtis','32 Derpstreet','PTSB_1');
INSERT INTO CUSTOMER VALUES(3,'Evan','Conlon','277 Glenview Park','BOI_Tal1');

INSERT INTO ACCOUNTS VALUES('23224411', 'CA','1',1234, 2, 100);      
INSERT INTO ACCOUNTS VALUES('11122113', 'SA', '0', 1324, 3, 120);                       
INSERT INTO ACCOUNTS VALUES('45682231', 'CA', '0', 1111, 0 , 1);

INSERT INTO SAVINGSACCOUNT VALUES('11122113', 0, ' ');

INSERT INTO CURRENTACCOUNT VALUES('23224411');
INSERT INTO CURRENTACCOUNT VALUES('45682231');

INSERT INTO CUSTACCOUNT VALUES('1','23224411');
INSERT INTO CUSTACCOUNT VALUES('2','45682231');
INSERT INTO CUSTACCOUNT VALUES('3','11122113');

INSERT INTO LODGEMENTS VALUES(1, '60', 'Bonus', '23224411');
INSERT INTO LODGEMENTS VALUES(2, '60', 'Bet', '23224411');
INSERT INTO LODGEMENTS VALUES(3, '40', 'Wage', '11122113');
INSERT INTO LODGEMENTS VALUES(4, '40', 'Taxback', '11122113');
INSERT INTO LODGEMENTS VALUES(5, '40', 'Bonus', '11122113');

INSERT INTO WITHDRAWALS VALUES(1, '20', 'Macdonalds', '23224411');
*/